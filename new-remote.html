<!DOCTYPE html>
<html lang="en">

<head>
<!--__RIM_REDIRECT__-->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@300..700&display=swap" rel="stylesheet">

<title>New remote</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<meta name="HandheldFriendly" content="True"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<link rel="canonical" href="https://rimstone-lang.com/new-remote.html" />
<style>


body, html {
    font-family: Quicksand,monospace,Helvetica, Arial, sans-serif;
    line-height: 150%;
    font-size:16px;
}

body {
    padding-left:1vw;
    padding-right:1vw;
}
    
.ncode {
    letter-spacing: 0px;
    font-family: monospace;
    font-size:83%;
    display:inline-block;
    max-width:99%;
    min-width:90%;
    margin:0;
    padding:0;
    padding-left:5px;
    padding-top:3px;
    padding-bottom:3px;
    margin-bottom:8px;
    margin-top:8px;
    border: 2px solid #d6d6d6;
    background-color:#f5f7f4;
    white-space:nowrap;
}

.shcode {
    letter-spacing: 0px;
    font-family: monospace;
    font-size:83%;
    display:inline-block;
    max-width:99%;
    min-width:90%;
    margin:0;
    padding:0;
    padding-left:5px;
    padding-top:3px;
    padding-bottom:3px;
    margin-bottom:8px;
    margin-top:8px;
    border: 2px solid #d6d6d6;
    background-color:#f5f7f4;
    white-space:nowrap;
}

.sqlcode {
    letter-spacing: 0px;
    font-family: monospace;
    font-size:83%;
    display:inline-block;
    max-width:99%;
    min-width:90%;
    margin:0;
    padding:0;
    padding-left:5px;
    padding-top:3px;
    padding-bottom:3px;
    margin-bottom:8px;
    margin-top:8px;
    border: 2px solid #d6d6d6;
    background-color:#f5f7f4;
    white-space:nowrap;
}

.htmlcode {
    letter-spacing: 0px;
    font-family: monospace;
    font-size:83%;
    display:inline-block;
    max-width:99%;
    min-width:90%;
    margin:0;
    padding:0;
    padding-left:5px;
    padding-top:3px;
    padding-bottom:3px;
    margin-bottom:8px;
    margin-top:8px;
    border: 2px solid #d6d6d6;
    background-color:#f5f7f4;
    white-space:nowrap;
}

.code {
    letter-spacing: 0px;
    font-family: monospace;
    font-size:83%;
    display:inline-block;
    max-width:99%;
    min-width:90%;
    margin:0;
    padding:0;
    padding-left:5px;
    padding-top:3px;
    padding-bottom:3px;
    margin-bottom:8px;
    margin-top:8px;
    border: 2px solid #d6d6d6;
    background-color:#f5f7f4;
    white-space:nowrap;
}

/*Just like h1 but for pdf conversion it would be indented this way it's not*/
.vhub {
    display: block;
   font-size: 1.6em;
   margin-top: 0.63em;
   margin-bottom: 0.63em;
   margin-left: 0;
   margin-right: 0;
   font-weight: bold;
}

/*Just like h2 but for pdf conversion it would be indented this way it's not*/
.vsub {
    display: block;
   font-size: 1.25em;
   margin-top: 0.53em;
   margin-bottom: 0.53em;
   margin-left: 0;
   margin-right: 0;
   font-weight: bold;
}

ul {
  margin-left: 0.75vw;
  padding-left: 0;
}
li {
  margin-left: 0.75vw;
  padding-left: 0;
}

/* this must be last, as it overrides previous settings, for mobile */
@media (hover: none) {
a {
   display: inline-block;
   padding-top: 3px;
   padding-bottom: 2px;
}
body {
    padding-left:2vw;
    padding-right:2vw;
    letter-spacing: 1px;
}
}

/*The following is for code snippets that are highlighted by 2html vim*/
pre { overflow-x: scroll; margin:0; padding:0; font-family:monospace; }
.Identifier { color: #008b8b; }
.Statement { color: #af5f00; }
.PreProc { color: #5fd7ff; }
.Type { color: #005f00; }
.Comment { color: blue ; }
.Constant { color: #ff00ff; }
/*end of highlighted snippets*/

a {
    text-decoration:none;
    padding-bottom: 0px; 
    color:inherit;
    border-bottom: 2px solid #6cb8f0;
}
a:hover {
    text-decoration: none;
    color:black;
    border-bottom: 1px solid red;
}
/*do not underline links nor should they be active*/
pre a {
    text-decoration:none;
    color:black;
    border-bottom: none;
    pointer-events: none;
    cursor: default;
}


.golfSnippet {display:none;}

ul {
  list-style-type:square;
  list-style-position: outside;
}

</style>


</head>
<body>
<div id="google_translate_element" style='float:right'></div>
<script type="text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>
<script>
function rim_copy(gt, eid, gc) {
  gt.textContent = eid.textContent;
  gt.select();
  document.execCommand("copy");
  gc.style.visibility="visible"
  setTimeout(()=>{ gc.style.visibility="hidden"; }, 1000);
}
function googleTranslateElementInit() {
   new google.translate.TranslateElement({pageLanguage: 'en'}, 'google_translate_element');
}

</script>

<!--RIMMENU13-->

<!--RIMENDMENU13-->



<!--BEGVDOC90-->
<div class='vhub' style='margin-top:10px;margin-right:20px;text-align:left;background-color:white;'><a href='https://rimstone-lang.com' style='border-bottom:0px'><img src='https://rimstone-lang.com/rimstone.png' style='width:180px;height:auto'/></a></div><div class='vhub' style='margin-top:10px;'>New remote</div><hr/><span style="font-weight:bold;">Purpose</span>: Create resources for a service call.<br/>
<br/>
<div class='code'  style='position:relative;padding-right:16px;'>
<pre id='code_817' class=notranslate>
<span class="Statement">new-remote</span> &lt;service&gt; \
    (<span class="Identifier"> local</span> &lt;app name&gt; ) | (<span class="Identifier"> location</span> &lt;location&gt; ) \
   <span class="Identifier"> url-path</span> &lt;service URL&gt; |
        ( \
       <span class="Identifier"> app-path</span> &lt;app path&gt; \
       <span class="Identifier"> request-path</span> &lt;request path&gt; \
        [<span class="Identifier"> url-params</span> &lt;url params&gt; ] \
        ) \
    [<span class="Identifier"> request-body content</span> &lt;content&gt; \
        [<span class="Identifier"> content-length</span> &lt;content length&gt; ] \
        [<span class="Identifier"> content-type</span> &lt;content type&gt; ] ] \
    [<span class="Identifier"> method</span> &lt;request method&gt; ] \
    [<span class="Identifier"> environment</span> &lt;name&gt;=&lt;value&gt; [<span class="Statement"> ,</span> ... ] ] \
    [<span class="Identifier"> timeout</span> &lt;timeout&gt; ]</pre>
<span id=rimstone_copied_817 style='position:absolute;right:-14px;top:-30px; cursor: pointer;visibility:hidden;background:white;'>Copied!</span>
<textarea id='rimstonet_817' style='position: absolute;left: -500%;'></textarea>
<img src='https://rimstone-lang.com/rimstone-copy-small-1.png' id='rimstoneb' onclick='rim_copy(rimstonet_817, code_817, rimstone_copied_817)' style='position:absolute;right:0;top:0; cursor: pointer;opacity:0.5;'/>
</div><br/>
new-remote will create resources needed for a service call (see <a href='https://rimstone-lang.com/call-remote.html'>call-remote</a>); these resources are contained in variable &lt;service&gt;.<br/>
<div class="vsub"><a id="Local or location"></a>Local or location</div>
If "local" clause is used, then service is a RimStone application running on the same computer, and the name of this application is string &lt;app name&gt;. <br/>
<br/>
If "local" is not used, then you must use "location" clause. &lt;location&gt; (in "location" clause) is a string representing either a Unix socket or a TCP socket of a remote service, and is:<br/>
<ul><li>for a Unix socket, a fully qualified name to a Unix socket file used to communicate with the service (for a RimStone server, it's "$HOME/.rimstone/apps/&lt;app name&gt;/sock/sock", where &lt;app name&gt; is the application name), or<br/>
</li><li>for a TCP socket, a host name and a port number in the form of "&lt;host name&gt;:&lt;port number&gt;", specifying where the service is listening on (for instance "127.0.0.1:2301" if the service is local and runs on TCP port 2301).</li></ul>
<div class="vsub"><a id="url-path or its components"></a>url-path or its components</div>
If "url-path" is used, then it's a <a href='https://rimstone-lang.com/request.html'>URL path</a> to a service. <br/>
<br/>
If "url-path" is not used, then you must use "app-path" and "request-path" clauses with optional "url-params" clause. &lt;app path&gt; string (in "app-path" clause) is the application path used to access a URL resource in service &lt;location&gt;, &lt;request path&gt; string (in "request-path" clause) is the <a href='https://rimstone-lang.com/request.html'>request</a> path used to access a URL resource in service &lt;location&gt;, while &lt;url params&gt; string (in "url-params" clause) is the URL parameters, see <a href='https://rimstone-lang.com/request.html'>request</a>.<br/>
<div class="vsub"><a id="Optional"></a>Optional</div>
&lt;request method&gt; string (in "method" clause) is a request method, such as "GET", "POST", "DELETE", "PUT" etc. The default is "GET".<br/>
<br/>
Request body (i.e. body content) is specified via "request-body" clause. Within it, &lt;content&gt; (in "content" subclause) is the actual body content string. &lt;content length&gt; &nbsp;(in "content-length" subclause) specifies the number of bytes in &lt;content&gt;; by default it will be the string length of &lt;content&gt; (see <a href='https://rimstone-lang.com/string-length.html'>string-length</a>). Mandatory &lt;content type&gt; (in "content-type" subclause) is the body content type (for instance &nbsp;"application/json" or "image/jpg").<br/>
<br/>
&lt;url params&gt; string (in "url-params" clause) is the URL parameters, see <a href='https://rimstone-lang.com/request.html'>request</a>.<br/>
<br/>
&lt;environment&gt; (in "environment" clause) is the environment passed to a service call, in the form of "name"="value" string list where such environment elements are separated by a comma. This way you can send any environment variables to the request executed remotely. For a RimStone server, you can access those variables in a remote request by using "environment" clause of <a href='https://rimstone-lang.com/get-sys.html'>get-sys</a> statement. There is no limit on the number of environment variables you can use this way, other than the underlying communication library.<br/>
<br/>
&lt;timeout&gt; (in "timeout" clause) is the number of seconds after which a service call will timeout; meaning the duration of a service call should not exceed this period of time. For no timeout, specify 0. Note that time needed for a DNS resolution of &lt;location&gt; is not counted in &lt;timeout&gt;. Maximum value is 86400 seconds. Even though it's optional, it is recommended to specify &lt;timeout&gt; in order to avoid a RimStone process waiting for a very long time. Note that even if your service call times out, the actual request executing on the server may continue until it's done.<br/>
<div class="vsub"><a id="Examples"></a>Examples</div>
In this example, 3 service calls are created ("srv1", "srv2" and "srv3"), and they will each make a service request. <br/>
<br/>
Each service request will add a key ("key1" with data "data_1", "key2" with data "data_2" and "key3" with data "data_3"). <br/>
<br/>
All three service calls connect via Unix socket. <br/>
<br/>
A full URL path of a service request (for "srv1" for example), would be "/app/manage-keys/op=add/key=key_1/data=data_1" (note that "app" is the application name and "manage-keys" is the request handler that provides the service).<br/>
<br/>
Copy this to "manage_keys.rim" source file:<br/>
<div class='code'  style='position:relative;padding-right:16px;'>
<pre id='code_819' class=notranslate>
<span class="Statement">%%</span> /manage-keys<span class="Identifier"> public</span>
<span class="Statement">   do-once</span>
<span class="Statement">   new-hash</span> h<span class="Identifier"> hash-size</span> <span class="Constant">1024</span><span class="Identifier"> process-scope</span>
<span class="Statement">   end-do-once</span>

   <span class="Comment">// Get input parameters</span>
<span class="Statement">   get-param</span> op
<span class="Statement">   get-param</span> key
<span class="Statement">   get-param</span> data<span class="Identifier"> default-value</span> <span class="Constant">&quot;&quot;</span>

<span class="Statement">   if-true</span> op<span class="Identifier"> equal</span> <span class="Constant">&quot;add&quot;</span> <span class="Comment">// Add data to hash,</span>
<span class="Statement">       write-hash</span> h<span class="Identifier"> key</span> (key)<span class="Identifier"> value</span> data<span class="Type"> status</span> st
<span class="Statement">       @</span>Added [<span class="Statement">&lt;&lt;print-out</span> key<span class="Statement">&gt;&gt;</span>]
<span class="Statement">   else-if</span> op<span class="Identifier"> equal</span> <span class="Constant">&quot;delete&quot;</span> <span class="Comment">// Delete data and obtain the value deleted</span>
<span class="Statement">       read-hash</span> h<span class="Type"> key</span> (key)<span class="Type"> value</span> val \
          <span class="Identifier"> delete</span> \
          <span class="Type"> status</span> st
<span class="Statement">       if-true</span> st<span class="Identifier"> equal</span> RIM_ERR_EXIST
<span class="Statement">           @</span>Not found [<span class="Statement">&lt;&lt;print-out</span> key<span class="Statement">&gt;&gt;</span>]
<span class="Statement">       else-if</span>
           <span class="Comment">// If found, then delete key and value</span>
<span class="Statement">           @</span>Deleted [<span class="Statement">&lt;&lt;print-out</span> val<span class="Statement">&gt;&gt;</span>]
<span class="Statement">           delete-string</span> val
<span class="Statement">       end-if</span>
<span class="Statement">   else-if</span> op<span class="Identifier"> equal</span> <span class="Constant">&quot;query&quot;</span> <span class="Comment">// Query hash based on key value</span>
<span class="Statement">       read-hash</span> h<span class="Type"> key</span> (key)<span class="Type"> value</span> val<span class="Type"> status</span> st
<span class="Statement">       if-true</span> st<span class="Identifier"> equal</span> RIM_ERR_EXIST
<span class="Statement">           @</span>Not found, queried [<span class="Statement">&lt;&lt;print-out</span> key<span class="Statement">&gt;&gt;</span>]
<span class="Statement">       else-if</span>
<span class="Statement">           @</span>Value [<span class="Statement">&lt;&lt;print-out</span> val<span class="Statement">&gt;&gt;</span>]
<span class="Statement">       end-if</span>
<span class="Statement">   end-if</span>
<span class="Statement">%%</span></pre>
<span id=rimstone_copied_819 style='position:absolute;right:-14px;top:-30px; cursor: pointer;visibility:hidden;background:white;'>Copied!</span>
<textarea id='rimstonet_819' style='position: absolute;left: -500%;'></textarea>
<img src='https://rimstone-lang.com/rimstone-copy-small-1.png' id='rimstoneb' onclick='rim_copy(rimstonet_819, code_819, rimstone_copied_819)' style='position:absolute;right:0;top:0; cursor: pointer;opacity:0.5;'/>
</div><br/>
Then <a href='https://rimstone-lang.com/call-remote.html'>call-remote</a> will make three service calls to the above request handler in parallel (i.e. as threads executing at the same time). You can examine if everything went okay, how many threads have started, and how many finished with a reply from the service (this means any kind of reply, even if an error). Finally, the output from each call is displayed (that's "data" clause in <a href='https://rimstone-lang.com/read-remote.html'>read-remote</a> statement at the end).<br/>
<br/>
Create file "srv.rim" and copy to it this code:<br/>
<div class='code'  style='position:relative;padding-right:16px;'>
<pre id='code_821' class=notranslate>
<span class="Statement">begin-handler</span> /srv<span class="Identifier"> public</span>
 <span class="Comment">// Create resources (prepare) for 3 service calls</span>
 <span class="Comment">// We pass environment variable RIM_SILENT_HEADER to these calls</span>
 <span class="Comment">// so they don't emit HTTP header</span>
<span class="Statement"> new-remote</span> srv1<span class="Identifier"> local</span> <span class="Constant">&quot;app&quot;</span> \
    <span class="Identifier"> url-path</span> <span class="Constant">&quot;/app/manage-keys/op=add/key=key1/data=data1&quot;</span> \
    <span class="Identifier"> environment</span> <span class="Constant">&quot;RIM_SILENT_HEADER&quot;</span>=<span class="Constant">&quot;yes&quot;</span>
<span class="Statement"> new-remote</span> srv2<span class="Identifier"> local</span> <span class="Constant">&quot;app&quot;</span> \
    <span class="Identifier"> url-path</span> <span class="Constant">&quot;/app/manage-keys/op=add/key=key2/data=data2&quot;</span> \
    <span class="Identifier"> environment</span> <span class="Constant">&quot;RIM_SILENT_HEADER&quot;</span>=<span class="Constant">&quot;yes&quot;</span>
<span class="Statement"> new-remote</span> srv3<span class="Identifier"> local</span> <span class="Constant">&quot;app&quot;</span> \
    <span class="Identifier"> url-path</span> <span class="Constant">&quot;/app/manage-keys/op=add/key=key3/data=data3&quot;</span> \
    <span class="Identifier"> environment</span> <span class="Constant">&quot;RIM_SILENT_HEADER&quot;</span>=<span class="Constant">&quot;yes&quot;</span>
 <span class="Comment">// Make 3 service calls in parallel, each in it own thread</span>
<span class="Statement"> call-remote</span> srv1, srv2, srv3<span class="Type"> status</span> st \
    <span class="Type"> started</span> start \
    <span class="Type"> finished-okay</span> fok
 <span class="Comment">// Check if all calls were completed</span>
<span class="Statement"> if-true</span> st<span class="Identifier"> equal</span> RIM_OKAY
<span class="Statement">     @</span>No errors from call-remote
<span class="Statement"> end-if</span>
<span class="Statement"> if-true</span> start<span class="Identifier"> equal</span> <span class="Constant">3</span>
<span class="Statement">     @</span>All three service calls started.
<span class="Statement"> end-if</span>
<span class="Statement"> if-true</span> fok<span class="Identifier"> equal</span> <span class="Constant">3</span>
<span class="Statement">     @</span>All three service calls finished.
<span class="Statement"> end-if</span>
<span class="Statement"> read-remote</span> srv1<span class="Identifier"> data</span> rdata1
<span class="Statement"> read-remote</span> srv2<span class="Identifier"> data</span> rdata2
<span class="Statement"> read-remote</span> srv3<span class="Identifier"> data</span> rdata3
<span class="Statement"> print-out</span> rdata1
<span class="Statement"> @</span>
<span class="Statement"> print-out</span> rdata2
<span class="Statement"> @</span>
<span class="Statement"> print-out</span> rdata3
<span class="Statement"> @</span>
<span class="Statement">end-handler</span></pre>
<span id=rimstone_copied_821 style='position:absolute;right:-14px;top:-30px; cursor: pointer;visibility:hidden;background:white;'>Copied!</span>
<textarea id='rimstonet_821' style='position: absolute;left: -500%;'></textarea>
<img src='https://rimstone-lang.com/rimstone-copy-small-1.png' id='rimstoneb' onclick='rim_copy(rimstonet_821, code_821, rimstone_copied_821)' style='position:absolute;right:0;top:0; cursor: pointer;opacity:0.5;'/>
</div><br/>
Create the application:<br/>
<div class="shcode" style='position:relative;padding-right:16px;'>
<pre id='code_818' class=notranslate>
rim <span class="Special">-k</span> app</pre>
<span id=rimstone_copied_818 style='position:absolute;right:-14px;top:-30px; cursor: pointer;visibility:hidden;background:white;'>Copied!</span>
<textarea id='rimstonet_818' style='position: absolute;left: -500%;'></textarea>
<img src='https://rimstone-lang.com/rimstone-copy-small-1.png' id='rimstoneb' onclick='rim_copy(rimstonet_818, code_818, rimstone_copied_818)' style='position:absolute;right:0;top:0; cursor: pointer;opacity:0.5;'/>
</div><br/>
Make it:<br/>
<div class="shcode" style='position:relative;padding-right:16px;'>
<pre id='code_820' class=notranslate>
rim <span class="Special">-q</span></pre>
<span id=rimstone_copied_820 style='position:absolute;right:-14px;top:-30px; cursor: pointer;visibility:hidden;background:white;'>Copied!</span>
<textarea id='rimstonet_820' style='position: absolute;left: -500%;'></textarea>
<img src='https://rimstone-lang.com/rimstone-copy-small-1.png' id='rimstoneb' onclick='rim_copy(rimstonet_820, code_820, rimstone_copied_820)' style='position:absolute;right:0;top:0; cursor: pointer;opacity:0.5;'/>
</div><br/>
Run it:<br/>
<div class="shcode" style='position:relative;padding-right:16px;'>
<pre id='code_822' class=notranslate>
mrim <span class="Special">-w</span> <span class="Constant">1</span> app</pre>
<span id=rimstone_copied_822 style='position:absolute;right:-14px;top:-30px; cursor: pointer;visibility:hidden;background:white;'>Copied!</span>
<textarea id='rimstonet_822' style='position: absolute;left: -500%;'></textarea>
<img src='https://rimstone-lang.com/rimstone-copy-small-1.png' id='rimstoneb' onclick='rim_copy(rimstonet_822, code_822, rimstone_copied_822)' style='position:absolute;right:0;top:0; cursor: pointer;opacity:0.5;'/>
</div><br/>
<div class="shcode" style='position:relative;padding-right:16px;'>
<pre id='code_823' class=notranslate>
rim <span class="Special">-r</span> <span class="Special">--req</span><span class="Statement">=</span><span class="Statement">&quot;</span><span class="Constant">/srv</span><span class="Statement">&quot;</span> <span class="Special">--exec</span> <span class="Special">--silent-header</span></pre>
<span id=rimstone_copied_823 style='position:absolute;right:-14px;top:-30px; cursor: pointer;visibility:hidden;background:white;'>Copied!</span>
<textarea id='rimstonet_823' style='position: absolute;left: -500%;'></textarea>
<img src='https://rimstone-lang.com/rimstone-copy-small-1.png' id='rimstoneb' onclick='rim_copy(rimstonet_823, code_823, rimstone_copied_823)' style='position:absolute;right:0;top:0; cursor: pointer;opacity:0.5;'/>
</div><br/>
And the result is (assuming you have started hash example above):<br/>
<div class='ncode' style='position:relative;padding-right:16px;'>
<pre id='code_816' class=notranslate>
No errors from call-remote
All three service calls started.
All three service calls finished.
Added [key1]

Added [key2]

Added [key3]</pre>
<span id=rimstone_copied_816 style='position:absolute;right:-14px;top:-30px; cursor: pointer;visibility:hidden;background:white;'>Copied!</span>
<textarea id='rimstonet_816' style='position: absolute;left: -500%;'></textarea>
<img src='https://rimstone-lang.com/rimstone-copy-small-1.png' id='rimstoneb' onclick='rim_copy(rimstonet_816, code_816, rimstone_copied_816)' style='position:absolute;right:0;top:0; cursor: pointer;opacity:0.5;'/>
</div><br/>
<div class="vsub"><a id="See also"></a>See also</div>
 <a name='Distributed computing'></a><span style="font-weight:bold;">Distributed computing</span><br/>
<a href='https://rimstone-lang.com/call-remote.html'>call-remote</a> &nbsp;<br/>
<a href='https://rimstone-lang.com/new-remote.html'>new-remote</a> &nbsp;<br/>
<a href='https://rimstone-lang.com/read-remote.html'>read-remote</a> &nbsp;<br/>
<a href='https://rimstone-lang.com/run-remote.html'>run-remote</a> &nbsp; <br/>
<span style="font-weight:bold;">See all</span> <br/>
<a href='https://rimstone-lang.com/documentation.html'>documentation</a><br/>
<!--ENDVDOC90-->
<br/><div style='width:100%;clear:both;'>
<hr/>
<!--GOLFFOOT77--><span style='font-size:80%'><a href="https://rimstone-lang.com/copyright.html">Copyright</a> (c) 2019-2025 Gliim LLC. All contents on this web site is "AS IS" without warranties or guarantees of any kind.</span>
</div><br/></body></html>


